import openpyxl
from pyOutlook import Outlook

# Define the path to your Excel file
excel_file_path = 'your_excel_file.xlsx'

# Load the Excel file
workbook = openpyxl.load_workbook(excel_file_path)
sheet = workbook.active

# Initialize Outlook client
outlook = Outlook()

# Loop through rows in the Excel file
for row in sheet.iter_rows(min_row=2, values_only=True):  # Assuming headers are in the first row
    sender = row[0]  # Column 1 contains the sender's email address
    subject = row[1]  # Column 2 contains the email subject
    category = row[2]  # Column 3 contains the category

    # Find emails matching sender and subject
    emails = outlook.search(sender=sender, subject=subject)

    # Ensure the category exists in Outlook
    if category not in outlook.get_categories():
        outlook.create_category(category)

    # Categorize matching emails
    for email in emails:
        email.set_categories(category)

# Save changes to the Outlook folder (e.g., Inbox)
outlook.save_changes()


